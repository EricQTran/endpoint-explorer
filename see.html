<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Super Endpoint Explorer</title>

	<!--Bootstrap-->
	<link href="css/bootstrap.min.css" rel="stylesheet">

	<style type="text/css">

  .btn{
    background-color: red;
  }
	
  body{
    background-color: lightgreen;
  }
	.dropdown{
		display: inline;
	}
	form{
		display: inline;
	}

	#contain{
		display: inline;
		padding: 5px 5px 5px 5px;
	}


	</style>
</head>
<body>
	<div class="page-header">
		<h1>Super Endpoint Explorer</h1>
	</div>
	<!--Jquery for bootstrap-->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
	<script src="js/bootstrap.min.js"></script>

	<div class="dropdown" id="methodDropdown">
   	<button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown" id="httpName">Http Method
 	<span class="caret"></span></button>
 		<ul class="dropdown-menu">
   			 <li><a href=# onclick="changeMethodName('GET');">GET</a></li>
   			 <li><a href=# onclick="changeMethodName('POST');">POST</a></li>
  		</ul>
	</div>

	<form>	
	Custom Request:	<input type="url" name="customRequest" id="customRequestBox" placeholder="Type in a URL request">
  Payload: <input type="text" id="payload" placeholder="Type in a payload to be delivered">
	</form>

	<button type="button" class="btn btn-primary" onclick="sendRequest();" id="sendBtn">Send</button>
	<button type="button" class="btn btn-primary"  id="saveBtn" data-toggle="modal" data-target="#myModal">Save</button>

	<div class="dropdown" id="saveDropdown">
   	<button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">Saved Requests
 	<span class="caret"></span></button>
 		<ul class="dropdown-menu" id="savedList">
  	</ul>
	</div>

	<div class="container" id="contain">
    	<ul class="nav nav-tabs">
    		<li class="active"><a data-toggle="tab" href="#preview">Preview</a></li>
    		<li><a data-toggle="tab" href="#output">Output</a></li>
    		<li><a data-toggle="tab" href="#headers">Headers</a></li>
  		</ul>

  		<div class="tab-content">
    		<div id="preview" class="tab-pane fade in active">
      		<h3 id="previewHeader">Preview</h3>
    		</div>
    		<div id="headers" class="tab-pane fade">
      		<h3>Headers</h3>
      			<p id="headers">&nbsp</p>
      			
    		</div>
    		<div id="output" class="tab-pan fade">
    			<h3>Output</h3>
    			<p id="requestOutput">Output that will be shown here </p>
    		</div>
    
  		</div>
	</div>


    <div id="myModal" class="modal fade" role="dialog">
		<div class="modal-dialog">

    	<div class="modal-content">
    		<div class="modal-header">
        	<button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Request Name Required</h4>
      </div>
      <div class="modal-body">
        <p>Please specify a name to save your request.</p>
        <input type="text" name="savedName" placeholder="name" id="savedName">
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" onclick="saveRequest();" data-dismiss="modal">Save</button>
        <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
      </div>
    </div>

  </div>
</div>

	<script type="text/javascript">

	var httpMethod;

    function getAllSaved()
    {
      for(i=0; i <= localStorage.length-1; i++)
      {
        key = localStorage.key(i);
        alert(localStorage.getItem(key));
      }
    }

		function changeMethodName(methodName)
		{
			var methDropdown = document.getElementById("httpName");
			methDropdown.innerHTML = methodName;
			httpMethod = methodName;

		}
		
		function submitRequest()
		{
			var requestBox = document.getElementById("customRequestBox");


			requestBox.value = "bam!"
		}

		function saveRequest()
		{
			var savedName = document.getElementById("savedName").value;
			var requestBoxUrl = document.getElementById("customRequestBox");
			localStorage.setItem(savedName, requestBoxUrl.value);
      var ul = document.getElementById('savedList');
      var aRef = document.createElement("a");
      var li= document.createElement("li");
      aRef.href="#";
      aRef.appendChild(document.createTextNode(savedName));
      li.appendChild(aRef);
      ul.appendChild(li);
			alert("localStorage Set!");
      getAllSaved();

		}

		function createXHR()
		{
   			try { return new XMLHttpRequest(); } catch(e) {}
   			try { return new ActiveXObject("Msxml2.XMLHTTP.6.0"); } catch (e) {}
   			try { return new ActiveXObject("Msxml2.XMLHTTP.3.0"); } catch (e) {}
   			try { return new ActiveXObject("Msxml2.XMLHTTP"); } catch (e) {}
   			try { return new ActiveXObject("Microsoft.XMLHTTP"); } catch (e) {}
   
   			alert("XMLHttpRequest not supported");   
   			return null;
		}
 
		function sendRequest()
		{
    		var xhr = createXHR();
    		var theUrl = document.getElementById("customRequestBox").value;
        var thePayload = document.getElementById("payload").value;

		    if (xhr)
     		{
     			if(httpMethod == "GET"){
     				xhr.open("GET",theUrl+"?"+thePayload,true);
      				xhr.onreadystatechange = function(){handleResponse(xhr);};
      				xhr.send(null);
     			}
     			if(httpMethod == "POST"){
     				xhr.open("POST", theUrl, true);
     				xhr.onreadystatechange = function(){handleResponse(xhr);};
     				xhr.send("true && false");
     			}
     		}
		}
 
		function handleResponse(xhr)
		{
  			if (xhr.readyState == 4  && xhr.status == 200)
    		{
     			var responseTxt = xhr.responseText;
     			var responseXml = xhr.responseXML;

     			var output = document.getElementById('requestOutput');
     			output.innerHTML = responseTxt;
          var headers= document.getElementById('headers');
          headers.innerHTML = xhr.getAllResponseHeaders();
          console.log(xhr.getAllResponseHeaders());
    		}
		}

	</script>

</body>
</html>